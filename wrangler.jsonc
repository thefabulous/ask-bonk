{
  "$schema": "node_modules/wrangler/config-schema.json",
  "name": "ask-bonk",
  "main": "src/index.ts",
  "compatibility_date": "2026-02-14",
  "rules": [
    {
      "type": "Text",
      "globs": ["**/*.hbs", "**/*.sql"],
      "fallthrough": true,
    },
  ],
  "compatibility_flags": ["nodejs_compat"],
  // Build-time constants replaced by esbuild. Deploy script overrides with real values.
  "define": {
    "__VERSION__": "\"dev\"",
    "__COMMIT__": "\"unknown\"",
  },
  "observability": {
    "enabled": true,
    "traces": {
      "enabled": true,
      "head_sampling_rate": 0.1,
    },
  },
  "vars": {
    // Default model for OpenCode sessions
    "DEFAULT_MODEL": "opencode/claude-opus-4-5",
    // ASK_SECRET: Set via wrangler secret for production
    // Empty or missing = /ask endpoint is disabled
    // Allowed orgs/users for GitHub App installation
    "ALLOWED_ORGS": ["thefabulous"],
  },
  // "containers": [
  // 	{
  // 		"class_name": "Sandbox",
  // 		"image": "./Dockerfile",
  // 		"instance_type": "standard-2",
  // 		"max_instances": 10,
  // 	},
  // ],
  "durable_objects": {
    "bindings": [
      {
        "class_name": "Sandbox",
        "name": "Sandbox",
      },
      {
        "class_name": "RepoAgent",
        "name": "REPO_AGENT",
      },
    ],
  },
  "migrations": [
    {
      "tag": "v4",
      "new_sqlite_classes": ["RepoAgent", "Sandbox"],
    },
  ],
  "kv_namespaces": [
    {
      "binding": "APP_INSTALLATIONS",
      "id": "46782abb12d54e0e9a88da860c922c80",
    },
  ],
  // Rate limiter for issues events from non-write users: 5 requests per minute
  "ratelimits": [
    {
      "name": "RATE_LIMITER",
      "namespace_id": "1001",
      "simple": {
        "limit": 5,
        "period": 60,
      },
    },
  ],
  "analytics_engine_datasets": [
    {
      "binding": "BONK_EVENTS",
      "dataset": "bonk_events",
    },
  ],
}
